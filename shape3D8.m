function [N,DN] = shape3D8 (XI)

N = zeros(1,8);
DN = zeros(3,8);

s = XI(1);
t = XI(2);
r = XI(3);

N(1) = 1/8*(1-s)*(1-t)*(1-r);
N(2) = 1/8*(1+s)*(1-t)*(1-r);
N(3) = 1/8*(1+s)*(1+t)*(1-r); 
N(4) = 1/8*(1-s)*(1+t)*(1-r); 
N(5) = 1/8*(1-s)*(1-t)*(1+r);  
N(6) = 1/8*(1+s)*(1-t)*(1+r); 
N(7) = 1/8*(1+s)*(1+t)*(1+r); 
N(8) = 1/8*(1-s)*(1+t)*(1+r);

DN(1,1) = -1/8*(1-t)*(1-r);
DN(1,2) =  1/8*(1-t)*(1-r);
DN(1,3) =  1/8*(1+t)*(1-r); 
DN(1,4) = -1/8*(1+t)*(1-r); 
DN(1,5) = -1/8*(1-t)*(1+r);  
DN(1,6) =  1/8*(1-t)*(1+r); 
DN(1,7) =  1/8*(1+t)*(1+r); 
DN(1,8) = -1/8*(1+t)*(1+r);

DN(2,1) = -1/8*(1-s)*(1-r);
DN(2,2) = -1/8*(1+s)*(1-r);
DN(2,3) =  1/8*(1+s)*(1-r); 
DN(2,4) =  1/8*(1-s)*(1-r); 
DN(2,5) = -1/8*(1-s)*(1+r);  
DN(2,6) = -1/8*(1+s)*(1+r); 
DN(2,7) =  1/8*(1+s)*(1+r); 
DN(2,8) =  1/8*(1-s)*(1+r);

DN(3,1) = -1/8*(1-s)*(1-t);
DN(3,2) = -1/8*(1+s)*(1-t);
DN(3,3) = -1/8*(1+s)*(1+t); 
DN(3,4) = -1/8*(1-s)*(1+t); 
DN(3,5) = 1/8*(1-s)*(1-t);  
DN(3,6) = 1/8*(1+s)*(1-t); 
DN(3,7) = 1/8*(1+s)*(1+t); 
DN(3,8) = 1/8*(1-s)*(1+t);



