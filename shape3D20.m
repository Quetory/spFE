function [N,DN] = shape3D20 (XI)

N = zeros(1,20);
DN = zeros(3,20);
B  = zeros(6,20*3);


s = XI(1);
t = XI(2);
r = XI(3);

N(1)  = 1/8*(1-s)   *(1-t)   *(1-r)  *(-s-t-r-2);
N(2)  = 1/8*(1+s)   *(1-t)   *(1-r)  *( s-t-r-2);
N(3)  = 1/8*(1+s)   *(1+t)   *(1-r)  *( s+t-r-2);
N(4)  = 1/8*(1-s)   *(1+t)   *(1-r)  *(-s+t-r-2);
N(5)  = 1/8*(1-s)   *(1-t)   *(1+r)  *(-s-t+r-2);
N(6)  = 1/8*(1+s)   *(1-t)   *(1+r)  *( s-t+r-2);
N(7)  = 1/8*(1+s)   *(1+t)   *(1+r)  *( s+t+r-2);
N(8)  = 1/8*(1-s)   *(1+t)   *(1+r)  *(-s+t+r-2);

N(9)  = 1/4*(1-s^2) *(1-t)   *(1-r);
N(10) = 1/4*(1+s)   *(1-t^2) *(1-r);
N(11) = 1/4*(1-s^2) *(1+t)   *(1-r);
N(12) = 1/4*(1-s)   *(1-t^2) *(1-r);
N(13) = 1/4*(1-s^2) *(1-t)   *(1+r);
N(14) = 1/4*(1+s)   *(1-t^2) *(1+r);
N(15) = 1/4*(1-s^2) *(1+t)   *(1+r);
N(16) = 1/4*(1-s)   *(1-t^2) *(1+r);
N(17) = 1/4*(1-s)   *(1-t)   *(1-r^2);
N(18) = 1/4*(1+s)   *(1-t)   *(1-r^2);
N(19) = 1/4*(1+s)   *(1+t)   *(1-r^2);
N(20) = 1/4*(1-s)   *(1+t)   *(1-r^2);
                                             
DN(1,1)  =  ((r - 1)*(t - 1)*(r + 2*s + t + 1))/8;          
DN(1,2)  = -((r - 1)*(t - 1)*(r - 2*s + t + 1))/8;          
DN(1,3)  =  ((r - 1)*(t + 1)*(r - 2*s - t + 1))/8;          
DN(1,4)  = -((r - 1)*(t + 1)*(r + 2*s - t + 1))/8; 
DN(1,5)  = -((r + 1)*(t - 1)*(2*s - r + t + 1))/8; 
DN(1,6)  = -((r + 1)*(t - 1)*(r + 2*s - t - 1))/8; 
DN(1,7)  =  ((r + 1)*(t + 1)*(r + 2*s + t - 1))/8; 
DN(1,8)  = -((r + 1)*(t + 1)*(r - 2*s + t - 1))/8; 
DN(1,9)  =                 -(s*(r - 1)*(t - 1))/2; 
DN(1,10) =                  ((t^2 - 1)*(r - 1))/4; 
DN(1,11) =                  (s*(r - 1)*(t + 1))/2; 
DN(1,12) =                 -((t^2 - 1)*(r - 1))/4; 
DN(1,13) =                  (s*(r + 1)*(t - 1))/2; 
DN(1,14) =                 -((t^2 - 1)*(r + 1))/4; 
DN(1,15) =                 -(s*(r + 1)*(t + 1))/2; 
DN(1,16) =                  ((t^2 - 1)*(r + 1))/4; 
DN(1,17) =                 -((r^2 - 1)*(t - 1))/4; 
DN(1,18) =                  ((r^2 - 1)*(t - 1))/4; 
DN(1,19) =                 -((r^2 - 1)*(t + 1))/4; 
DN(1,20) =                  ((r^2 - 1)*(t + 1))/4;
                
DN(2,1)  =  ((r - 1)*(s - 1)*(r + s + 2*t + 1))/8; 
DN(2,2)  = -((r - 1)*(s + 1)*(r - s + 2*t + 1))/8; 
DN(2,3)  =  ((r - 1)*(s + 1)*(r - s - 2*t + 1))/8; 
DN(2,4)  = -((r - 1)*(s - 1)*(r + s - 2*t + 1))/8; 
DN(2,5)  = -((r + 1)*(s - 1)*(s - r + 2*t + 1))/8; 
DN(2,6)  = -((r + 1)*(s + 1)*(r + s - 2*t - 1))/8; 
DN(2,7)  =  ((r + 1)*(s + 1)*(r + s + 2*t - 1))/8; 
DN(2,8)  = -((r + 1)*(s - 1)*(r - s + 2*t - 1))/8; 
DN(2,9)  =                 -(s^2/4 - 1/4)*(r - 1); 
DN(2,10) =                2*t*(s/4 + 1/4)*(r - 1); 
DN(2,11) =                  (s^2/4 - 1/4)*(r - 1); 
DN(2,12) =               -2*t*(s/4 - 1/4)*(r - 1); 
DN(2,13) =                  (s^2/4 - 1/4)*(r + 1); 
DN(2,14) =               -2*t*(s/4 + 1/4)*(r + 1); 
DN(2,15) =                 -(s^2/4 - 1/4)*(r + 1); 
DN(2,16) =                2*t*(s/4 - 1/4)*(r + 1); 
DN(2,17) =                 -(r^2 - 1)*(s/4 - 1/4); 
DN(2,18) =                  (r^2 - 1)*(s/4 + 1/4); 
DN(2,19) =                 -(r^2 - 1)*(s/4 + 1/4);                   
DN(2,20) =                  (r^2 - 1)*(s/4 - 1/4);  
              
DN(3,1)  =  ((s - 1)*(t - 1)*(2*r + s + t + 1))/8;  
DN(3,2)  = -((s + 1)*(t - 1)*(2*r - s + t + 1))/8;  
DN(3,3)  =  ((s + 1)*(t + 1)*(2*r - s - t + 1))/8;  
DN(3,4)  = -((s - 1)*(t + 1)*(2*r + s - t + 1))/8;  
DN(3,5)  = -((s - 1)*(t - 1)*(s - 2*r + t + 1))/8;  
DN(3,6)  = -((s + 1)*(t - 1)*(2*r + s - t - 1))/8;  
DN(3,7)  =  ((s + 1)*(t + 1)*(2*r + s + t - 1))/8;  
DN(3,8)  = -((s - 1)*(t + 1)*(2*r - s + t - 1))/8;  
DN(3,9)  =                 -(s^2/4 - 1/4)*(t - 1);  
DN(3,10) =                  (s/4 + 1/4)*(t^2 - 1);  
DN(3,11) =                  (s^2/4 - 1/4)*(t + 1);  
DN(3,12) =                 -(s/4 - 1/4)*(t^2 - 1);  
DN(3,13) =                  (s^2/4 - 1/4)*(t - 1);  
DN(3,14) =                 -(s/4 + 1/4)*(t^2 - 1);  
DN(3,15) =                 -(s^2/4 - 1/4)*(t + 1);  
DN(3,16) =                  (s/4 - 1/4)*(t^2 - 1);  
DN(3,17) =               -2*r*(s/4 - 1/4)*(t - 1);  
DN(3,18) =                2*r*(s/4 + 1/4)*(t - 1);  
DN(3,19) =               -2*r*(s/4 + 1/4)*(t + 1);  
DN(3,20) =                2*r*(s/4 - 1/4)*(t + 1);  
