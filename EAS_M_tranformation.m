function [T] = EAS_M_tranformation(XYZ)
[~,DN] = shape3D8([0,0,0]);
J0 = DN*XYZ;
J0i = eye(3)/J0;
dJ0 = det(J0);

JJ = J0;
% T11 = J0.'.^2;
% T12 = [ 2*J0(1,1)*J0(2,1) 2*J0(1,1)*J0(3,1) 2*J0(2,1)*J0(3,1) ;...
%         2*J0(1,2)*J0(2,2) 2*J0(1,2)*J0(3,2) 2*J0(2,2)*J0(3,2) ;...
%         2*J0(1,3)*J0(2,3) 2*J0(1,3)*J0(3,3) 2*J0(2,3)*J0(3,3) ];
%         
% T21 = [ J0(1,1)*J0(1,2) J0(2,1)*J0(2,2) J0(3,1)*J0(3,2) ; ... 
%         J0(1,1)*J0(1,3) J0(2,1)*J0(2,3) J0(3,1)*J0(3,3) ; ... 
%         J0(1,2)*J0(1,3) J0(2,2)*J0(2,3) J0(3,2)*J0(3,3) ];
%         
% T22 = [ J0(1,1)*J0(2,2) + J0(2,1)*J0(1,2), J0(1,1)*J0(3,2) + J0(3,1)*J0(1,2), J0(2,1)*J0(3,2) + J0(3,1)*J0(2,2);...       
%         J0(1,1)*J0(2,3) + J0(2,1)*J0(1,3), J0(1,1)*J0(3,3) + J0(3,1)*J0(1,3), J0(2,1)*J0(3,3) + J0(3,1)*J0(2,3);...
%         J0(1,2)*J0(2,3) + J0(2,2)*J0(1,3), J0(1,2)*J0(3,3) + J0(3,2)*J0(1,3), J0(2,2)*J0(3,3) + J0(3,2)*J0(2,3) ] ;
% 
% 
% T0 = [  T11 T12 ; ...
%         T21 T22 ];
    
% T = dJ0*(inv(T0.'));
% T11 = J0i.*J0i;
% T12 = [ J0i(1,1)*J0i(1,2) J0i(1,2)*J0i(1,3) J0i(1,1)*J0i(1,3);...
%         J0i(2,1)*J0i(2,2) J0i(2,2)*J0i(2,3) J0i(2,1)*J0i(2,3);...
%         J0i(3,1)*J0i(3,2) J0i(3,2)*J0i(3,3) J0i(3,1)*J0i(3,3)];
% 
% T21 = 2*[ J0i(1,1)*J0i(2,1) J0i(1,2)*J0i(2,2) J0i(1,3)*J0i(2,3);...
%           J0i(2,1)*J0i(3,1) J0i(2,2)*J0i(3,2) J0i(2,3)*J0i(3,3);...
%           J0i(1,1)*J0i(3,1) J0i(1,2)*J0i(3,2) J0i(1,3)*J0i(3,3)];
%       
% T22 = [ J0i(1,1)*J0i(2,2)+J0i(1,2)*J0i(2,1) J0i(1,2)*J0i(2,3)+J0i(2,2)*J0i(1,3)  J0i(1,1)*J0i(2,3)+J0i(2,1)*J0i(1,3) ;...
%         J0i(2,1)*J0i(3,2)+J0i(2,2)*J0i(3,1) J0i(2,2)*J0i(3,3)+J0i(3,2)*J0i(2,3)  J0i(2,1)*J0i(3,3)+J0i(3,1)*J0i(2,3) ;...
%         J0i(1,1)*J0i(3,2)+J0i(1,2)*J0i(3,1) J0i(1,2)*J0i(3,3)+J0i(3,2)*J0i(1,3)  J0i(1,1)*J0i(3,3)+J0i(3,1)*J0i(1,3) ];
% 
% T0 = [T11 T12; T21 T22];


T=zeros(6);
T(1:3,1:3) = JJ.*JJ;

T(1:3,4:6)=A*JJ(:,[1 1 2]).*JJ(:,[2 3 3]);
T(4:6,1:3)=B*JJ([1 1 2],:).*JJ([2 3 3],:);


T(4,4)=JJ(1,1)*JJ(2,2)+JJ(1,2)*JJ(2,1);
T(4,5)=JJ(1,1)*JJ(2,3)+JJ(1,3)*JJ(2,1);
T(4,6)=JJ(1,2)*JJ(2,3)+JJ(1,3)*JJ(2,2);

T(5,4)=JJ(1,1)*JJ(3,2)+JJ(1,2)*JJ(3,1);
T(5,5)=JJ(1,1)*JJ(3,3)+JJ(1,3)*JJ(3,1);
T(5,6)=JJ(1,2)*JJ(3,3)+JJ(1,3)*JJ(3,2);

T(6,4)=JJ(2,1)*JJ(3,2)+JJ(2,2)*JJ(3,1);
T(6,5)=JJ(2,1)*JJ(3,3)+JJ(2,3)*JJ(3,1);
T(6,6)=JJ(2,2)*JJ(3,3)+JJ(2,3)*JJ(3,2);
